(function(){const r=document.createElement("link").relList;if(r&&r.supports&&r.supports("modulepreload"))return;for(const t of document.querySelectorAll('link[rel="modulepreload"]'))s(t);new MutationObserver(t=>{for(const o of t)if(o.type==="childList")for(const f of o.addedNodes)f.tagName==="LINK"&&f.rel==="modulepreload"&&s(f)}).observe(document,{childList:!0,subtree:!0});function l(t){const o={};return t.integrity&&(o.integrity=t.integrity),t.referrerPolicy&&(o.referrerPolicy=t.referrerPolicy),t.crossOrigin==="use-credentials"?o.credentials="include":t.crossOrigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function s(t){if(t.ep)return;t.ep=!0;const o=l(t);fetch(t.href,o)}})();const F=[{value:2,color:"bg-orange-200"},{value:4,color:"bg-orange-300"},{value:8,color:"bg-orange-400"},{value:16,color:"bg-orange-500"},{value:32,color:"bg-orange-600"},{value:64,color:"bg-amber-400"},{value:128,color:"bg-amber-500"},{value:256,color:"bg-yellow-500"},{value:512,color:"bg-red-400"},{value:1028,color:"bg-red-500"},{value:2048,color:"bg-red-700"}],T=()=>JSON.parse(localStorage.getItem("bestScore2048Game"))||0,I=e=>{messageField.removeAttribute("style"),messageTitle.innerText=e==="loss"?"Game is over!":"You won!",messageText.innerText=e==="loss"?"no moves available":"you've reached 2048 tile"},y=e=>new Array(e).fill(null).map(()=>new Array(e).fill(0)),O=e=>e.flat().some(l=>l===0),v=(e,r)=>e.flat().every((s,t)=>s===r.flat()[t]);window.onload=()=>p();const S=document.querySelector("#field"),B=document.querySelector("#totalScore"),N=document.querySelector("#bestScore"),C=document.getElementById("messageField");document.getElementById("messageTitle");document.getElementById("messageText");const L=document.getElementById("newGameButton");C.style.display="none";let a=[],n=[],u=0;const V=.7,A="flex items-center justify-center text-4xl font-bold rounded-md text-slate-50";let b=!0,x=!0,h=!0,w=!0;document.addEventListener("keyup",e=>{if(P(),e.key==="ArrowLeft"){G(),h&&i();return}if(e.key==="ArrowRight"){q(),b&&i();return}if(e.key==="ArrowDown"){k(),x&&i();return}e.key==="ArrowUp"&&(R(),w&&i())});const d=()=>{S.innerHTML="",a.flat().forEach(e=>{const r=document.createElement("div");e===0?(r.innerText="",r.classList.value=`${A} bg-stone-50/50`):(r.innerText=e,F.forEach(l=>{l.value===e&&(r.classList.value=`${A} ${l.color}`)}),e===2048&&I("victory")),S.appendChild(r)})},p=()=>{const e=T();a=y(4),C.style.display="none",N.innerText=e,i(),i()},i=()=>{const e=Math.random()>=V?4:2;let r=!1,l=O(a);for(;!r&&l;){let s=Math.floor(Math.random()*4),t=s,o=s;a[t][o]===0&&(a[t][o]=e,r=!0)}d()},G=()=>{let e=[...a];a=g(a,"direct"),h=!v(e,a),d()},q=()=>{let e=[...a];a=g(a,"reverse"),b=!v(e,a),d()},R=()=>{n=y(4),a.forEach((l,s)=>{l.forEach((t,o)=>{n[o][s]=t})});let e=[...n];n=g(n,"direct"),n.forEach((l,s)=>{l.forEach((t,o)=>{a[o][s]=t})}),w=!v(e,n),d()},k=()=>{n=y(4),a.forEach((l,s)=>{l.forEach((t,o)=>{n[o][s]=t})});let e=[...n];n=g(n,"reverse"),n.forEach((l,s)=>{l.forEach((t,o)=>{a[o][s]=t})}),x=!v(e,n),d()},g=(e,r)=>e.map(s=>{let t=s.filter(c=>c>0),o;r==="reverse"?o=t.reverse():o=t;let m=o.map((c,M,E)=>c===E[M+1]?D(E,M,c):c).filter(c=>c>0);for(;m.length<4;)m.push(0);return r==="reverse"?m.reverse():m}),D=(e,r,l)=>{e.splice(1,r+1);const s=l*2;return $(s),s},P=()=>{if(x===!1&&w===!1&&h===!1&&b===!1){I("loss"),L.addEventListener("click",p);return}L.removeEventListener("click",p)},$=e=>{const r=T();if(u+=e,B.innerText=u,u<r)return;const l=u;N.innerText=u,localStorage.setItem("bestScore2048Game",JSON.stringify(l))};
